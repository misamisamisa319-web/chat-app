import express from "express";
import http from "http";
import { Server } from "socket.io";
import fs from "fs";

const app = express();
const server = http.createServer(app);
const io = new Server(server);

app.use(express.static("public"));

let users = [];
let messagesLog = [];

/* ===== ãƒ­ã‚°ä¿å­˜ ===== */
const LOG_FILE = "./logs.json";
if (fs.existsSync(LOG_FILE)) {
  try { messagesLog = JSON.parse(fs.readFileSync(LOG_FILE, "utf8")); }
  catch { messagesLog = []; }
}
function saveLogs() {
  fs.writeFileSync(LOG_FILE, JSON.stringify(messagesLog, null, 2));
}

/* ===== ç®¡ç†è€…ãƒ­ã‚° ===== */
app.get("/admin", (req, res) => {
  if (req.query.key !== process.env.ADMIN_KEY) {
    return res.status(403).send("Forbidden");
  }
  const rows = messagesLog.map(m => `
    <tr>
      <td>${m.time || ""}</td>
      <td>${m.room}</td>
      <td>${m.name}</td>
      <td>${m.private ? "å†…ç·’" : "é€šå¸¸"}</td>
      <td>${m.text}</td>
    </tr>
  `).join("");
  res.send(`
    <!doctype html><html lang="ja"><head><meta charset="utf-8">
    <title>ç®¡ç†è€…ãƒ­ã‚°</title>
    <style>
      body{font-family:sans-serif;padding:20px}
      table{border-collapse:collapse;width:100%}
      th,td{border:1px solid #ccc;padding:6px}
      th{background:#f0f0f0}
    </style></head><body>
      <h2>ç®¡ç†è€…ãƒ­ã‚°</h2>
      <table>
        <tr><th>æ™‚åˆ»</th><th>éƒ¨å±‹</th><th>åå‰</th><th>ç¨®åˆ¥</th><th>å†…å®¹</th></tr>
        ${rows}
      </table>
    </body></html>
  `);
});

/* ===== ãƒ­ãƒ“ãƒ¼æƒ…å ± ===== */
function getLobbyInfo() {
  const rooms = {};
  users.forEach(u => {
    if (!rooms[u.room]) rooms[u.room] = { count: 0, names: [] };
    rooms[u.room].count++;
    rooms[u.room].names.push(u.name);
  });
  return rooms;
}

/* ===== å€‹å®¤éµ ===== */
const roomKeys = {
  privateA: "1234a",
  privateB: "1234b",
  privateC: "1234c",
  privateD: "1234d",
};

/* ===== æ™‚åˆ» ===== */
function getTimeString() {
  const d = new Date(
    new Date().toLocaleString("ja-JP", { timeZone: "Asia/Tokyo" })
  );
  return `${String(d.getHours()).padStart(2,"0")}:${String(d.getMinutes()).padStart(2,"0")}`;
}

/* ===============================
   ç½°ï¼ˆå…ƒã®ã¾ã¾ãƒ»è‰²ã¤ãï¼‰
================================ */
// å¥³å­ç½°30å€‹
const punishItems = [
"å¥³å­ç½°1.å‹è€…ã®æŒ‡å®šã™ã‚‹æ–¹æ³•ã§1d5+3åˆ†é–“ã®å…¨åŠ›ã‚ªãƒŠãƒ‹ãƒ¼ï¼ˆãƒ«ãƒ–ãƒ«ã«ã¦1d5ã®ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚Šã€Œâ—‹åˆ†é–“å…¨åŠ›ã‚ªãƒŠãƒ‹ãƒ¼ã‚’ã—ã¾ã™ã€ã¨ç™ºè¨€ã—ã€ä»Šã®å¿ƒå¢ƒã‚‚æ›¸ãæ®‹ã—ã¦ãã‚‹ã“ã¨ï¼‰",
"å¥³å­ç½°2.å…¨è£¸ã«ãªã‚Šè„šã‚’é–‹ãã€äººå·®ã—æŒ‡ã¨ä¸­æŒ‡ã§ã‚¯ãƒªãƒˆãƒªã‚¹ã‚’è»½ãæŒŸã¿è¾¼ã‚“ã§æ“¦ã‚‹ã€‚3åˆ†ä»¥å†…ã«100å¾€å¾©ã“ã™ã‚‹ã€‚",
"å¥³å­ç½°3.ã€Œå‹åˆ©è€…æ§˜ã«ã‚ªãƒŠãƒ‹ãƒ¼ã‚’ã™ã‚‹ã¨ã“ã‚ã‚’è¦‹ã¦ã„ãŸã ã„ã¦ã„ã¾ã™ã€‚è¦‹å­¦è€…ãŒå¤šã„ã»ã©èˆˆå¥®ã—ã¾ã™ã€‚æ˜¯éè¦‹ã«æ¥ã¦ãã ã•ã„â™¡æ®‹ã‚Šç½°å›æ•°ã¯ã€‡å›ã§ã™ã€ã¨ãƒ«ãƒ–ãƒ«ã®éƒ¨å±‹ã§å®£ä¼ã—ã€èª°ã‹ãŒæ¥ã‚‹ã¾ã§ãŠã¾ã‚“ã“ã«äººå·®ã—æŒ‡ã¨ä¸­æŒ‡ãƒ»ã‚¯ãƒªãƒˆãƒªã‚¹ã«è¦ªæŒ‡ã‚’å½“ã¦ã€è†£ã®ä¸­ã§è¦ªæŒ‡ã¨ä¸­æŒ‡ã‚’ãã£ã¤ã‘ã‚‹ã‚ˆã†ã«å‹•ã‹ã—ç¶šã‘ã‚‹ã€‚",
"å¥³å­ç½°4.åˆ©ãæ‰‹ã¨ã¯é€†ã®æ‰‹ã®è¦ªæŒ‡ã¨ä¸­æŒ‡ã§å·¦ä¹³é¦–ã‚’æŒŸã¿ã‚¯ãƒ‹ã‚¯ãƒ‹ã—ãªãŒã‚‰ã€åˆ©ãæ‰‹ã®ä¸­æŒ‡ãƒ»è–¬æŒ‡ã§ã‚¯ãƒªãƒˆãƒªã‚¹ã‚’æŒŸã¿å·¦å³ã«3åˆ†ä»¥å†…180å¾€å¾©å‹•ã‹ã™",
"å¥³å­ç½°5.äººå·®æŒ‡orä¸­æŒ‡ã‚’ã‚¯ãƒªãƒˆãƒªã‚¹ã«å½“ã¦ã€PCã®ãƒã‚¦ã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ãã‚‰ã„ã®å¼·ã•ã§ã‚¯ãƒªãƒˆãƒªã‚¹ã‚’1åˆ†ä»¥å†…60å›ã‚¿ãƒƒãƒ—ã™ã‚‹ã€‚",
"å¥³å­ç½°6.èˆŒãƒ»ä¸¡ä¹³é¦–ã«æ´—æ¿¯ã°ã•ã¿ã‚’ã¤ã‘ã¦ç½°ã‚’ç¶šã‘ã‚‹ã€ç„¡ç†ãªå ´åˆãã®ç®‡æ‰€åˆ†Ã—ï¼’å›ç½°è¿½åŠ ",
"å¥³å­ç½°7.ãŠå°»ã®ç©´ã«ç¶¿æ£’ãƒ»ãƒšãƒ³ãƒ»ã‚¢ãƒŠãƒ«ãƒ—ãƒ©ã‚°ãªã©ã‚’1æœ¬å…¥ã‚Œã‚‹ã€‚å…¥ã‚ŒãŸã‚‚ã®ã‚’å ±å‘Šã™ã‚‹ã“ã¨ã€‚",
"å¥³å­ç½°8.ãƒ¡ãƒ³ã‚½ãƒ¬ãƒ¼ã‚¿ãƒ ã‚’ä¹³é¦–ã¨ã‚¯ãƒªã¨ã‚ªãƒãƒ³ã‚³ã«å¡—ã‚Šè¾¼ã‚€ã€ãªã„å ´åˆã¯ãƒ•ãƒªãƒ¼å‘½ä»¤",
"å¥³å­ç½°9.å‹è€…ã¯å¥½ããªè³ªå•ã‚’3ã¤(ãŸã ã—ä½æ‰€ã‚„é›»è©±ç•ªå·ç­‰ã®è³ªå•ã¯ä¸å¯)ã€‚ç½°è€…ã¯æ­£ç›´ã«ç­”ãˆãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ç­”ãˆã‚‰ã‚Œãªã„ã¨ã—ãŸå ´åˆã¯ç½°å›æ•°+2ã€‚",
"å¥³å­ç½°10.å‹è€…ã‹ã‚‰ã®ãƒ•ãƒªãƒ¼å‘½ä»¤",
"å¥³å­ç½°11.å‹åˆ©è€…ã®æŒ‡å®šã™ã‚‹æ–¹æ³•ã§ã‚ªãƒŠãƒ‹ãƒ¼ã‚’ã—ã¦å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"å¥³å­ç½°12.å…¥å®¤è€…ã®æ•°ã ã‘å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã‚’ã™ã‚‹ã€‚",
"å¥³å­ç½°13.ç©å…·ã‚’å…¨ã¦å‘Šç™½ã—ã€å‹è€…ãŒé¸ã‚“ã é“å…·(è¤‡æ•°åŒæ™‚å¯)ã‚’ä½¿ç”¨ã—ã¦ä¸€å›å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã™ã‚‹ã€‚ç©å…·ãŒãªã„å ´åˆã¯å¯¸æ­¢ã‚3å›é€£ç¶šã™ã‚‹ã€‚",
"å¥³å­ç½°14.ãƒ«ãƒ–ãƒ«ã®éƒ¨å±‹ä¸Šã’ã‚’ã—ã¦ã€Œä»Šã‹ã‚‰å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã—ã¾ã™ã€‚è¦‹ã«æ¥ã¦ãã ã•ã„ã€ã¨ã¤ã¶ã‚„ãã€ä¸€å›å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã™ã‚‹ã€‚",
"å¥³å­ç½°15.è‡ªåˆ†ãŒæ€ã†ä¸€ç•ªæƒ¨ã‚ã§æ¥ãšã‹ã—ãæ„Ÿã˜ã‚„ã™ã„ã‚ªãƒŠãƒ‹ãƒ¼ã®ä»•æ–¹ã‚’å‘Šç™½ã—ã€ãã®æ–¹æ³•ã§ä¸€å›å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"å¥³å­ç½°16.ã‚ªãƒŠãƒ‹ãƒ¼ã®é »åº¦ã¨ä¸€ç•ªå¥½ããªã‚ªãƒŠãƒ‹ãƒ¼ã®ãŠã‹ãšãƒ»æ–¹æ³•ã‚’å‘Šç™½ã™ã‚‹ã€‚ãã®å¾Œã€å‘Šç™½ã—ãŸæ–¹æ³•ã§ä¸€å›å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"å¥³å­ç½°17.æ€§æ„Ÿå¸¯ã‚’å‘Šç™½ã—ã€ãã“ã‚’é‡ç‚¹çš„ã«æ”»ã‚ãŸã‚ªãƒŠãƒ‹ãƒ¼ã§ä¸€å›å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"å¥³å­ç½°18.å››ã¤ã‚“é€™ã„ã«ãªã£ã¦éƒ¨å±‹ã‚’1å‘¨æ­©ãã€ãã®éš›éƒ¨å±‹ã®ç´¹ä»‹ã‚’ã™ã‚‹ã€‚",
"å¥³å­ç½°19.(è‡ªåˆ†ãŒ)ã•ã‚ŒãŸã„äº‹/(ç›¸æ‰‹ã«)ã•ã›ãŸã„äº‹ã‚’ãã‚Œãã‚Œæ­£ç›´ã«å‘Šç™½ã€‚",
"å¥³å­ç½°20.ä»Šã¾ã§å—ã‘ãŸæœ€ã‚‚æ¥ãšã‹ã—ã„ä½“é¨“ã‚’å‘Šç™½ã™ã‚‹ã€‚",
"å¥³å­ç½°21.ç¾åœ¨ã®ä¸‹åŠèº«ã‚’å†™çœŸã«å–ã‚Šã€æºå¸¯ã«1é€±é–“ä¿ç®¡ã™ã‚‹",
"å¥³å­ç½°22.å‹åˆ©è€…ã‹ã‚‰å¥½ããªç®‡æ‰€ã«è½æ›¸ãã‚’1ã¤ã—ã¦å†™çœŸã‚’æ’®ã‚Šãƒ­ãƒƒã‚¯ç”»é¢ã«3æ—¥ã™ã‚‹ã€‚",
"å¥³å­ç½°23.å‹åˆ©è€…ã‹ã‚‰å¥½ããªç®‡æ‰€ã«è½æ›¸ãã‚’1ã¤ã—ã¦ãƒ©ã‚¤ãƒ³orã‚«ã‚«ã‚ªã®ç•°æ€§ã«1äººã«ã€Œä»Šã®å§¿ã‚’èª¬æ˜ã—ã©ã†æ€ã†ï¼Ÿã€ã¨é€ã‚‹ã€‚å‡ºæ¥ãªã„å ´åˆã¯å‹åˆ©è€…ãŒãƒ•ãƒªãƒ¼å‘½ä»¤ã€‚",
"å¥³å­ç½°24.ãƒ©ã‚¤ãƒ³orã‚«ã‚«ã‚ªã®ç•°æ€§ã«1äººã«ã€Œç§ã«ã‚¨ãƒƒãƒãªå‘½ä»¤ã—ã¦ã€ã¨é€ã‚‹ã€‚å‡ºæ¥ãªã„å ´åˆã¯å‹åˆ©è€…ãŒãƒ•ãƒªãƒ¼å‘½ä»¤ã€‚",
"å¥³å­ç½°25.HNã‚’å‹åˆ©è€…ã®æŒ‡å®šã™ã‚‹åå‰ã«å¤‰ãˆã‚‹ãã—ã¦ã€ãƒ©ã‚¤ãƒ³orã‚«ã‚«ã‚ªã®åå‰ã‚’ç¾çŠ¶ã®åå‰ã«çµ‚ã‚ã‚‹ã¾ã§å¤‰ãˆã‚‹ã€‚å‡ºæ¥ãªã„å ´åˆã¯å‹åˆ©è€…ãŒãƒ•ãƒªãƒ¼å‘½ä»¤ã€‚ï¼ˆä¾‹ï¼šé›‘é­šãƒãƒ³ã‚³åå‰ï¼‰",
"å¥³å­ç½°26.HNã‚’å‹åˆ©è€…ã®æŒ‡å®šã™ã‚‹åå‰ã«å¤‰ãˆã‚‹ã€‚ãƒ«ãƒ–ãƒ«ã®éƒ¨å±‹ä¸Šã’ã‚’ã—ã¦ã€å‹åˆ©è€…ã®æŒ‡å®šã—ãŸè¨€è‘‰ã‚’ã¤ã¶ã‚„ã",
"å¥³å­ç½°27.å®Ÿæ³ã—ãªãŒã‚‰å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ï¼ˆä¿ç•™å¯ï¼‰",
"å¥³å­ç½°28.å®Ÿæ³ã—ãªãŒã‚‰ã‚¤ã‚¯ã¾ã§ã‚ªãƒŠãƒ‹ãƒ¼(ä¿ç•™å¯)",
"å¥³å­ç½°29.ã€åœ°ç„ã€‘ã‚«ãƒ¼ãƒ†ãƒ³ã‚’å…¨é–‹ã®çª“éš›ã«ç«‹ã¡ã€å‹åˆ©è€…ã®æŒ‡å®šã—ãŸæ–¹æ³•ã§ä¸€å›å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã™ã‚‹ã€‚",
"å¥³å­ç½°30.ã€åœ°ç„ã€‘å‹åˆ©è€…ã®å¥´éš·ã«3æ—¥ãªã‚‹ã€‚",
];

// ç”·å­ç½°30å€‹
const boyPunishItems = [
"ç”·å­ç½°1.å¯¸æ­¢ã‚ï¼‘å›ã™ã‚‹ã€‚",
"ç”·å­ç½°2.å³ä¹³é¦–ã«æ€ã„ãã‚Šãƒ‡ã‚³ãƒ”ãƒ³ã‚’10å›ã™ã‚‹ã€‚",
"ç”·å­ç½°3.å·¦ä¹³é¦–ã«æ€ã„ãã‚Šãƒ‡ã‚³ãƒ”ãƒ³ã‚’10å›ã™ã‚‹ã€‚",
"ç”·å­ç½°4.å³ã®ãŠå°»ã‚’10å›å…¨åŠ›ã§å©ãã€‚",
"ç”·å­ç½°5.å·¦ã®ãŠå°»ã‚’10å›å…¨åŠ›ã§å©ãã€‚",
"ç”·å­ç½°6.èˆŒãƒ»ä¸¡ä¹³é¦–ã«æ´—æ¿¯ã°ã•ã¿ã‚’ã¤ã‘ã¦ç½°ã‚’ç¶šã‘ã‚‹ã€ç„¡ç†ãªå ´åˆãã®ç®‡æ‰€åˆ†Ã—ï¼’å›ç½°è¿½åŠ ",
"ç”·å­ç½°7.ãŠå°»ã®ç©´ã«ç¶¿æ£’ãƒ»ãƒšãƒ³ãƒ»ã‚¢ãƒŠãƒ«ãƒ—ãƒ©ã‚°ãªã©ã‚’1æœ¬å…¥ã‚Œã‚‹ã€‚å…¥ã‚ŒãŸã‚‚ã®ã‚’å ±å‘Šã™ã‚‹ã“ã¨ã€‚",
"ç”·å­ç½°8.ãƒ¡ãƒ³ã‚½ãƒ¬ãƒ¼ã‚¿ãƒ ã‚’ä¹³é¦–ã¨äº€é ­ã«å¡—ã‚Šè¾¼ã‚€",
"ç”·å­ç½°9.å‹è€…ã¯å¥½ããªè³ªå•ã‚’1ã¤(ãŸã ã—ä½æ‰€ã‚„é›»è©±ç•ªå·ç­‰ã®è³ªå•ã¯ä¸å¯)ã€‚ç½°è€…ã¯æ­£ç›´ã«ç­”ãˆãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ç­”ãˆã‚‰ã‚Œãªã„ã¨ã—ãŸå ´åˆã¯ç½°å›æ•°+2ã€‚",
"ç”·å­ç½°10.å››ã¤ã‚“é€™ã„ã«ãªã£ã¦éƒ¨å±‹ã‚’1å‘¨æ­©ãã€ãã®éš›éƒ¨å±‹ã®ç´¹ä»‹ã‚’ã™ã‚‹ã€‚",
"ç”·å­ç½°11.å‹è€…ã‹ã‚‰ã®ãƒ•ãƒªãƒ¼å‘½ä»¤",
"ç”·å­ç½°12.å‹åˆ©è€…ã®æŒ‡å®šã™ã‚‹æ–¹æ³•ã§ã‚ªãƒŠãƒ‹ãƒ¼ã‚’ã—ã¦å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"ç”·å­ç½°13.å…¥å®¤è€…ã®æ•°ã ã‘å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã‚’ã™ã‚‹ã€‚",
"ç”·å­ç½°14.ç©å…·ã‚’å…¨ã¦å‘Šç™½ã—ã€å‹è€…ãŒé¸ã‚“ã é“å…·(è¤‡æ•°åŒæ™‚å¯)ã‚’ä½¿ç”¨ã—ã¦ä¸€å›å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã™ã‚‹ã€‚ç©å…·ãŒãªã„å ´åˆã¯å¯¸æ­¢ã‚3å›é€£ç¶šã™ã‚‹ã€‚",
"ç”·å­ç½°15.ãƒ«ãƒ–ãƒ«ã®éƒ¨å±‹ä¸Šã’ã‚’ã—ã¦ã€Œä»Šã‹ã‚‰å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã—ã¾ã™ã€‚è¦‹ã«æ¥ã¦ãã ã•ã„ã€ã¨ã¤ã¶ã‚„ãã€ä¸€å›å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã™ã‚‹ã€‚",
"ç”·å­ç½°16.è‡ªåˆ†ãŒæ€ã†ä¸€ç•ªæƒ¨ã‚ã§æ¥ãšã‹ã—ãæ„Ÿã˜ã‚„ã™ã„ã‚ªãƒŠãƒ‹ãƒ¼ã®ä»•æ–¹ã‚’å‘Šç™½ã—ã€ãã®æ–¹æ³•ã§ä¸€å›å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"ç”·å­ç½°17.ã‚ªãƒŠãƒ‹ãƒ¼ã®é »åº¦ã¨ä¸€ç•ªå¥½ããªã‚ªãƒŠãƒ‹ãƒ¼ã®ãŠã‹ãšãƒ»æ–¹æ³•ã‚’å‘Šç™½ã™ã‚‹ã€‚ãã®å¾Œã€å‘Šç™½ã—ãŸæ–¹æ³•ã§ä¸€å›å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"ç”·å­ç½°18.æ€§æ„Ÿå¸¯ã‚’å‘Šç™½ã—ã€ãã“ã‚’é‡ç‚¹çš„ã«æ”»ã‚ãŸã‚ªãƒŠãƒ‹ãƒ¼ã§ä¸€å›å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"ç”·å­ç½°19.(è‡ªåˆ†ãŒ)ã•ã‚ŒãŸã„äº‹/(ç›¸æ‰‹ã«)ã•ã›ãŸã„äº‹ã‚’ãã‚Œãã‚Œæ­£ç›´ã«å‘Šç™½ã€‚",
"ç”·å­ç½°20.ä»Šã¾ã§å—ã‘ãŸæœ€ã‚‚æ¥ãšã‹ã—ã„ä½“é¨“ã‚’å‘Šç™½ã™ã‚‹ã€‚",
"ç”·å­ç½°21.ç¾åœ¨ã®ä¸‹åŠèº«ã‚’å†™çœŸã«å–ã‚Šã€æºå¸¯ã«3æ—¥ä¿ç®¡ã™ã‚‹",
"ç”·å­ç½°22.å‹åˆ©è€…ã‹ã‚‰å¥½ããªç®‡æ‰€ã«è½æ›¸ãã‚’1ã¤ã—ã¦å†™çœŸã‚’æ’®ã‚Šãƒ­ãƒƒã‚¯ç”»é¢ã«3æ—¥ã™ã‚‹ã€‚",
"ç”·å­ç½°23.å‹åˆ©è€…ã‹ã‚‰å¥½ããªç®‡æ‰€ã«è½æ›¸ãã‚’1ã¤ã—ã¦ãƒ©ã‚¤ãƒ³orã‚«ã‚«ã‚ªã®ç•°æ€§ã«1äººã«ã€Œä»Šã®å§¿ã‚’èª¬æ˜ã—ã©ã†æ€ã†ï¼Ÿã€ã¨é€ã‚‹ã€‚å‡ºæ¥ãªã„å ´åˆã¯å‹åˆ©è€…ãŒãƒ•ãƒªãƒ¼å‘½ä»¤ã€‚",
"ç”·å­ç½°24.ãƒ©ã‚¤ãƒ³orã‚«ã‚«ã‚ªã®ç•°æ€§ã«1äººã«ã€Œç§ã«ã‚¨ãƒƒãƒãªå‘½ä»¤ã—ã¦ã€ã¨é€ã‚‹ã€‚å‡ºæ¥ãªã„å ´åˆã¯å‹åˆ©è€…ãŒãƒ•ãƒªãƒ¼å‘½ä»¤ã€‚",
"ç”·å­ç½°25.HNã‚’å‹åˆ©è€…ã®æŒ‡å®šã™ã‚‹åå‰ã«å¤‰ãˆã‚‹ãã—ã¦ã€ãƒ©ã‚¤ãƒ³orã‚«ã‚«ã‚ªã®åå‰ã‚’ç¾çŠ¶ã®åå‰ã«çµ‚ã‚ã‚‹ã¾ã§å¤‰ãˆã‚‹ã€‚å‡ºæ¥ãªã„å ´åˆã¯å‹åˆ©è€…ãŒãƒ•ãƒªãƒ¼å‘½ä»¤ã€‚ï¼ˆä¾‹ï¼šé›‘é­šãƒãƒ³ã‚³åå‰ï¼‰",
"ç”·å­ç½°26.HNã‚’å‹åˆ©è€…ã®æŒ‡å®šã™ã‚‹åå‰ã«å¤‰ãˆã‚‹ã€‚ãƒ«ãƒ–ãƒ«ã«ã‚‚ãã®åå‰ã§ãƒ­ã‚°ã‚¤ãƒ³ã—å‹è€…ã®æŒ‡å®šã—ãŸè¨€è‘‰ã‚’ã¤ã¶ã‚„ã",
"ç”·å­ç½°27.å®Ÿæ³ã—ãªãŒã‚‰å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ï¼ˆä¿ç•™å¯ï¼‰",
"ç”·å­ç½°28.å®Ÿæ³ã—ãªãŒã‚‰ã‚¤ã‚¯ã¾ã§ã‚ªãƒŠãƒ‹ãƒ¼(ä¿ç•™å¯)",
"ç”·å­ç½°29.ã€åœ°ç„ã€‘å¥³æ€§åŒ–èª¿æ•™ã€‚å‹è€…ã«å¥³æ€§ã¨ã—ã¦ã®åå‰ã€åå‰ã®è‰²ã‚’ã¤ã‘ã¦ã‚‚ã‚‰ã†ã€‚ä¸€äººç§°ã¯ã€Œã‚ãŸã—ã€ã§ç”·è¨€è‘‰ä½¿ç”¨ç¦æ­¢ã€å¥³ã«ãªã‚Šãã£ã¦ãƒãƒ£ãƒƒãƒˆã™ã‚‹ã“ã¨ã€‚å¥³æ€§ç”¨ã‚·ãƒ§ãƒ¼ãƒ„ã¨ãƒ‘ãƒ³ã‚¹ãƒˆã€å®¶ã§ã¯ãƒ–ãƒ©ã‚„ãƒ‘ãƒƒãƒ‰ã€ã‚¹ã‚«ãƒ¼ãƒˆã‚‚æ‰‹ã«å…¥ã‚‹å ´åˆã¯èº«ã«ã¤ã‘ã‚‹ã€‚ä¸‹ç€ç¦æ­¢ã‚„è„±è¡£å‘½ä»¤ãŒå‡ºã¦ã‚‚è„±ãã®ã¯ç¦æ­¢ã€‚ãŠã¡ã‚“ã½ã¯ã‚¯ãƒªã€ã‚¢ãƒŠãƒ«ã¯ãŠã¾ã‚“ã“ã¨å‘¼ç§°ã™ã‚‹ã€‚ã‚ªãƒŠãƒ‹ãƒ¼ã™ã‚‹å ´åˆã¯æ™®é€šã«ã—ã”ãç”·ã¨ã—ã¦ã®ã‚ªãƒŠãƒ‹ãƒ¼ã‚’ç¦æ­¢ã—ã€å¥³æ€§ã®ã‚¯ãƒªã‚ªãƒŠã®ã‚ˆã†ã«æ’«ã§ã‚‹ã‚ˆã†ã«ã‚·ãƒ§ãƒ¼ãƒ„ã®ä¸Šã‹ã‚‰å–˜ããªãŒã‚‰è¡Œã†ã“ã¨ã€‚æœŸé–“ã¯æ¬¡ã«å‹è² ã«å‹ã¤ã¾ã§ã¨ã™ã‚‹ã€‚",
"ç”·å­ç½°30.ã€åœ°ç„ã€‘å‹åˆ©è€…ã®å¥´éš·ã«3æ—¥ãªã‚‹ã€‚",
];

const specialGirlPunishItems = [
"å¥³å­ç½°1.å‹è€…ã®æŒ‡å®šã™ã‚‹æ–¹æ³•ã§1d5+3åˆ†é–“ã®å…¨åŠ›ã‚ªãƒŠãƒ‹ãƒ¼ï¼ˆãƒ«ãƒ–ãƒ«ã«ã¦1d5ã®ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚Šã€Œâ—‹åˆ†é–“å…¨åŠ›ã‚ªãƒŠãƒ‹ãƒ¼ã‚’ã—ã¾ã™ã€ã¨ç™ºè¨€ã—ã€ä»Šã®å¿ƒå¢ƒã‚‚æ›¸ãæ®‹ã—ã¦ãã‚‹ã“ã¨ï¼‰",
"å¥³å­ç½°2.å…¨è£¸ã«ãªã‚Šè„šã‚’é–‹ãã€äººå·®ã—æŒ‡ã¨ä¸­æŒ‡ã§ã‚¯ãƒªãƒˆãƒªã‚¹ã‚’è»½ãæŒŸã¿è¾¼ã‚“ã§æ“¦ã‚‹ã€‚3åˆ†ä»¥å†…ã«100å¾€å¾©ã“ã™ã‚‹ã€‚",
"å¥³å­ç½°3.ã€Œå‹åˆ©è€…æ§˜ã«ã‚ªãƒŠãƒ‹ãƒ¼ã‚’ã™ã‚‹ã¨ã“ã‚ã‚’è¦‹ã¦ã„ãŸã ã„ã¦ã„ã¾ã™ã€‚è¦‹å­¦è€…ãŒå¤šã„ã»ã©èˆˆå¥®ã—ã¾ã™ã€‚æ˜¯éè¦‹ã«æ¥ã¦ãã ã•ã„â™¡æ®‹ã‚Šç½°å›æ•°ã¯ã€‡å›ã§ã™ã€ã¨ãƒ«ãƒ–ãƒ«ã®éƒ¨å±‹ã§å®£ä¼ã—ã€èª°ã‹ãŒæ¥ã‚‹ã¾ã§ãŠã¾ã‚“ã“ã«äººå·®ã—æŒ‡ã¨ä¸­æŒ‡ãƒ»ã‚¯ãƒªãƒˆãƒªã‚¹ã«è¦ªæŒ‡ã‚’å½“ã¦ã€è†£ã®ä¸­ã§è¦ªæŒ‡ã¨ä¸­æŒ‡ã‚’ãã£ã¤ã‘ã‚‹ã‚ˆã†ã«å‹•ã‹ã—ç¶šã‘ã‚‹ã€‚",
"å¥³å­ç½°4.åˆ©ãæ‰‹ã¨ã¯é€†ã®æ‰‹ã®è¦ªæŒ‡ã¨ä¸­æŒ‡ã§å·¦ä¹³é¦–ã‚’æŒŸã¿ã‚¯ãƒ‹ã‚¯ãƒ‹ã—ãªãŒã‚‰ã€åˆ©ãæ‰‹ã®ä¸­æŒ‡ãƒ»è–¬æŒ‡ã§ã‚¯ãƒªãƒˆãƒªã‚¹ã‚’æŒŸã¿å·¦å³ã«3åˆ†ä»¥å†…180å¾€å¾©å‹•ã‹ã™",
"å¥³å­ç½°5.äººå·®æŒ‡orä¸­æŒ‡ã‚’ã‚¯ãƒªãƒˆãƒªã‚¹ã«å½“ã¦ã€PCã®ãƒã‚¦ã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ãã‚‰ã„ã®å¼·ã•ã§ã‚¯ãƒªãƒˆãƒªã‚¹ã‚’1åˆ†ä»¥å†…60å›ã‚¿ãƒƒãƒ—ã™ã‚‹ã€‚",
"å¥³å­ç½°6.èˆŒãƒ»ä¸¡ä¹³é¦–ã«æ´—æ¿¯ã°ã•ã¿ã‚’ã¤ã‘ã¦ç½°ã‚’ç¶šã‘ã‚‹ã€ç„¡ç†ãªå ´åˆãã®ç®‡æ‰€åˆ†Ã—ï¼’å›ç½°è¿½åŠ ",
"å¥³å­ç½°7.ãŠå°»ã®ç©´ã«ç¶¿æ£’ãƒ»ãƒšãƒ³ãƒ»ã‚¢ãƒŠãƒ«ãƒ—ãƒ©ã‚°ãªã©ã‚’1æœ¬å…¥ã‚Œã‚‹ã€‚å…¥ã‚ŒãŸã‚‚ã®ã‚’å ±å‘Šã™ã‚‹ã“ã¨ã€‚",
"å¥³å­ç½°8.ãƒ¡ãƒ³ã‚½ãƒ¬ãƒ¼ã‚¿ãƒ ã‚’ä¹³é¦–ã¨ã‚¯ãƒªã¨ã‚ªãƒãƒ³ã‚³ã«å¡—ã‚Šè¾¼ã‚€ã€ãªã„å ´åˆã¯ãƒ•ãƒªãƒ¼å‘½ä»¤",
"å¥³å­ç½°9.å‹è€…ã¯å¥½ããªè³ªå•ã‚’3ã¤(ãŸã ã—ä½æ‰€ã‚„é›»è©±ç•ªå·ç­‰ã®è³ªå•ã¯ä¸å¯)ã€‚ç½°è€…ã¯æ­£ç›´ã«ç­”ãˆãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ç­”ãˆã‚‰ã‚Œãªã„ã¨ã—ãŸå ´åˆã¯ç½°å›æ•°+2ã€‚",
"å¥³å­ç½°10.å‹è€…ã‹ã‚‰ã®ãƒ•ãƒªãƒ¼å‘½ä»¤",
"å¥³å­ç½°11.å‹åˆ©è€…ã®æŒ‡å®šã™ã‚‹æ–¹æ³•ã§ã‚ªãƒŠãƒ‹ãƒ¼ã‚’ã—ã¦å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"å¥³å­ç½°12.å…¥å®¤è€…ã®æ•°ã ã‘å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã‚’ã™ã‚‹ã€‚",
"å¥³å­ç½°13.ç©å…·ã‚’å…¨ã¦å‘Šç™½ã—ã€å‹è€…ãŒé¸ã‚“ã é“å…·(è¤‡æ•°åŒæ™‚å¯)ã‚’ä½¿ç”¨ã—ã¦ä¸€å›å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã™ã‚‹ã€‚ç©å…·ãŒãªã„å ´åˆã¯å¯¸æ­¢ã‚3å›é€£ç¶šã™ã‚‹ã€‚",
"å¥³å­ç½°14.ãƒ«ãƒ–ãƒ«ã®éƒ¨å±‹ä¸Šã’ã‚’ã—ã¦ã€Œä»Šã‹ã‚‰å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã—ã¾ã™ã€‚è¦‹ã«æ¥ã¦ãã ã•ã„ã€ã¨ã¤ã¶ã‚„ãã€ä¸€å›å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã™ã‚‹ã€‚",
"å¥³å­ç½°15.è‡ªåˆ†ãŒæ€ã†ä¸€ç•ªæƒ¨ã‚ã§æ¥ãšã‹ã—ãæ„Ÿã˜ã‚„ã™ã„ã‚ªãƒŠãƒ‹ãƒ¼ã®ä»•æ–¹ã‚’å‘Šç™½ã—ã€ãã®æ–¹æ³•ã§ä¸€å›å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"å¥³å­ç½°16.ã‚ªãƒŠãƒ‹ãƒ¼ã®é »åº¦ã¨ä¸€ç•ªå¥½ããªã‚ªãƒŠãƒ‹ãƒ¼ã®ãŠã‹ãšãƒ»æ–¹æ³•ã‚’å‘Šç™½ã™ã‚‹ã€‚ãã®å¾Œã€å‘Šç™½ã—ãŸæ–¹æ³•ã§ä¸€å›å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"å¥³å­ç½°17.æ€§æ„Ÿå¸¯ã‚’å‘Šç™½ã—ã€ãã“ã‚’é‡ç‚¹çš„ã«æ”»ã‚ãŸã‚ªãƒŠãƒ‹ãƒ¼ã§ä¸€å›å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"å¥³å­ç½°18.å››ã¤ã‚“é€™ã„ã«ãªã£ã¦éƒ¨å±‹ã‚’1å‘¨æ­©ãã€ãã®éš›éƒ¨å±‹ã®ç´¹ä»‹ã‚’ã™ã‚‹ã€‚",
"å¥³å­ç½°19.(è‡ªåˆ†ãŒ)ã•ã‚ŒãŸã„äº‹/(ç›¸æ‰‹ã«)ã•ã›ãŸã„äº‹ã‚’ãã‚Œãã‚Œæ­£ç›´ã«å‘Šç™½ã€‚",
"å¥³å­ç½°20.ä»Šã¾ã§å—ã‘ãŸæœ€ã‚‚æ¥ãšã‹ã—ã„ä½“é¨“ã‚’å‘Šç™½ã™ã‚‹ã€‚",
"å¥³å­ç½°21.ç¾åœ¨ã®ä¸‹åŠèº«ã‚’å†™çœŸã«å–ã‚Šã€æºå¸¯ã«1é€±é–“ä¿ç®¡ã™ã‚‹",
"å¥³å­ç½°22.å‹åˆ©è€…ã‹ã‚‰å¥½ããªç®‡æ‰€ã«è½æ›¸ãã‚’1ã¤ã—ã¦å†™çœŸã‚’æ’®ã‚Šãƒ­ãƒƒã‚¯ç”»é¢ã«3æ—¥ã™ã‚‹ã€‚",
"å¥³å­ç½°23.å‹åˆ©è€…ã‹ã‚‰å¥½ããªç®‡æ‰€ã«è½æ›¸ãã‚’1ã¤ã—ã¦ãƒ©ã‚¤ãƒ³orã‚«ã‚«ã‚ªã®ç•°æ€§ã«1äººã«ã€Œä»Šã®å§¿ã‚’èª¬æ˜ã—ã©ã†æ€ã†ï¼Ÿã€ã¨é€ã‚‹ã€‚å‡ºæ¥ãªã„å ´åˆã¯å‹åˆ©è€…ãŒãƒ•ãƒªãƒ¼å‘½ä»¤ã€‚",
"å¥³å­ç½°24.ãƒ©ã‚¤ãƒ³orã‚«ã‚«ã‚ªã®ç•°æ€§ã«1äººã«ã€Œç§ã«ã‚¨ãƒƒãƒãªå‘½ä»¤ã—ã¦ã€ã¨é€ã‚‹ã€‚å‡ºæ¥ãªã„å ´åˆã¯å‹åˆ©è€…ãŒãƒ•ãƒªãƒ¼å‘½ä»¤ã€‚",
"å¥³å­ç½°25.HNã‚’å‹åˆ©è€…ã®æŒ‡å®šã™ã‚‹åå‰ã«å¤‰ãˆã‚‹ãã—ã¦ã€ãƒ©ã‚¤ãƒ³orã‚«ã‚«ã‚ªã®åå‰ã‚’ç¾çŠ¶ã®åå‰ã«çµ‚ã‚ã‚‹ã¾ã§å¤‰ãˆã‚‹ã€‚å‡ºæ¥ãªã„å ´åˆã¯å‹åˆ©è€…ãŒãƒ•ãƒªãƒ¼å‘½ä»¤ã€‚ï¼ˆä¾‹ï¼šé›‘é­šãƒãƒ³ã‚³åå‰ï¼‰",
"å¥³å­ç½°26.HNã‚’å‹åˆ©è€…ã®æŒ‡å®šã™ã‚‹åå‰ã«å¤‰ãˆã‚‹ã€‚ãƒ«ãƒ–ãƒ«ã®éƒ¨å±‹ä¸Šã’ã‚’ã—ã¦ã€å‹åˆ©è€…ã®æŒ‡å®šã—ãŸè¨€è‘‰ã‚’ã¤ã¶ã‚„ã",
"å¥³å­ç½°27.å®Ÿæ³ã—ãªãŒã‚‰å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ï¼ˆä¿ç•™å¯ï¼‰",
"å¥³å­ç½°28.å®Ÿæ³ã—ãªãŒã‚‰ã‚¤ã‚¯ã¾ã§ã‚ªãƒŠãƒ‹ãƒ¼(ä¿ç•™å¯)",
"å¥³å­ç½°29.ã€åœ°ç„ã€‘ã‚«ãƒ¼ãƒ†ãƒ³ã‚’å…¨é–‹ã®çª“éš›ã«ç«‹ã¡ã€å‹åˆ©è€…ã®æŒ‡å®šã—ãŸæ–¹æ³•ã§ä¸€å›å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã™ã‚‹ã€‚",
"å¥³å­ç½°30.ã€åœ°ç„ã€‘å‹åˆ©è€…ã®å¥´éš·ã«3æ—¥ãªã‚‹ã€‚",
];

const specialBoyPunishItems = [
"ç”·å­ç½°1.å¯¸æ­¢ã‚ï¼‘å›ã™ã‚‹ã€‚",
"ç”·å­ç½°2.å³ä¹³é¦–ã«æ€ã„ãã‚Šãƒ‡ã‚³ãƒ”ãƒ³ã‚’10å›ã™ã‚‹ã€‚",
"ç”·å­ç½°3.å·¦ä¹³é¦–ã«æ€ã„ãã‚Šãƒ‡ã‚³ãƒ”ãƒ³ã‚’10å›ã™ã‚‹ã€‚",
"ç”·å­ç½°4.å³ã®ãŠå°»ã‚’10å›å…¨åŠ›ã§å©ãã€‚",
"ç”·å­ç½°5.å·¦ã®ãŠå°»ã‚’10å›å…¨åŠ›ã§å©ãã€‚",
"ç”·å­ç½°6.èˆŒãƒ»ä¸¡ä¹³é¦–ã«æ´—æ¿¯ã°ã•ã¿ã‚’ã¤ã‘ã¦ç½°ã‚’ç¶šã‘ã‚‹ã€ç„¡ç†ãªå ´åˆãã®ç®‡æ‰€åˆ†Ã—ï¼’å›ç½°è¿½åŠ ",
"ç”·å­ç½°7.ãŠå°»ã®ç©´ã«ç¶¿æ£’ãƒ»ãƒšãƒ³ãƒ»ã‚¢ãƒŠãƒ«ãƒ—ãƒ©ã‚°ãªã©ã‚’1æœ¬å…¥ã‚Œã‚‹ã€‚å…¥ã‚ŒãŸã‚‚ã®ã‚’å ±å‘Šã™ã‚‹ã“ã¨ã€‚",
"ç”·å­ç½°8.ãƒ¡ãƒ³ã‚½ãƒ¬ãƒ¼ã‚¿ãƒ ã‚’ä¹³é¦–ã¨äº€é ­ã«å¡—ã‚Šè¾¼ã‚€",
"ç”·å­ç½°9.å‹è€…ã¯å¥½ããªè³ªå•ã‚’1ã¤(ãŸã ã—ä½æ‰€ã‚„é›»è©±ç•ªå·ç­‰ã®è³ªå•ã¯ä¸å¯)ã€‚ç½°è€…ã¯æ­£ç›´ã«ç­”ãˆãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ç­”ãˆã‚‰ã‚Œãªã„ã¨ã—ãŸå ´åˆã¯ç½°å›æ•°+2ã€‚",
"ç”·å­ç½°10.å››ã¤ã‚“é€™ã„ã«ãªã£ã¦éƒ¨å±‹ã‚’1å‘¨æ­©ãã€ãã®éš›éƒ¨å±‹ã®ç´¹ä»‹ã‚’ã™ã‚‹ã€‚",
"ç”·å­ç½°11.å‹è€…ã‹ã‚‰ã®ãƒ•ãƒªãƒ¼å‘½ä»¤",
"ç”·å­ç½°12.å‹åˆ©è€…ã®æŒ‡å®šã™ã‚‹æ–¹æ³•ã§ã‚ªãƒŠãƒ‹ãƒ¼ã‚’ã—ã¦å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"ç”·å­ç½°13.å…¥å®¤è€…ã®æ•°ã ã‘å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã‚’ã™ã‚‹ã€‚",
"ç”·å­ç½°14.ç©å…·ã‚’å…¨ã¦å‘Šç™½ã—ã€å‹è€…ãŒé¸ã‚“ã é“å…·(è¤‡æ•°åŒæ™‚å¯)ã‚’ä½¿ç”¨ã—ã¦ä¸€å›å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã™ã‚‹ã€‚ç©å…·ãŒãªã„å ´åˆã¯å¯¸æ­¢ã‚3å›é€£ç¶šã™ã‚‹ã€‚",
"ç”·å­ç½°15.ãƒ«ãƒ–ãƒ«ã®éƒ¨å±‹ä¸Šã’ã‚’ã—ã¦ã€Œä»Šã‹ã‚‰å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã—ã¾ã™ã€‚è¦‹ã«æ¥ã¦ãã ã•ã„ã€ã¨ã¤ã¶ã‚„ãã€ä¸€å›å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ã™ã‚‹ã€‚",
"ç”·å­ç½°16.è‡ªåˆ†ãŒæ€ã†ä¸€ç•ªæƒ¨ã‚ã§æ¥ãšã‹ã—ãæ„Ÿã˜ã‚„ã™ã„ã‚ªãƒŠãƒ‹ãƒ¼ã®ä»•æ–¹ã‚’å‘Šç™½ã—ã€ãã®æ–¹æ³•ã§ä¸€å›å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"ç”·å­ç½°17.ã‚ªãƒŠãƒ‹ãƒ¼ã®é »åº¦ã¨ä¸€ç•ªå¥½ããªã‚ªãƒŠãƒ‹ãƒ¼ã®ãŠã‹ãšãƒ»æ–¹æ³•ã‚’å‘Šç™½ã™ã‚‹ã€‚ãã®å¾Œã€å‘Šç™½ã—ãŸæ–¹æ³•ã§ä¸€å›å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"ç”·å­ç½°18.æ€§æ„Ÿå¸¯ã‚’å‘Šç™½ã—ã€ãã“ã‚’é‡ç‚¹çš„ã«æ”»ã‚ãŸã‚ªãƒŠãƒ‹ãƒ¼ã§ä¸€å›å¯¸æ­¢ã‚ã™ã‚‹ã€‚",
"ç”·å­ç½°19.(è‡ªåˆ†ãŒ)ã•ã‚ŒãŸã„äº‹/(ç›¸æ‰‹ã«)ã•ã›ãŸã„äº‹ã‚’ãã‚Œãã‚Œæ­£ç›´ã«å‘Šç™½ã€‚",
"ç”·å­ç½°20.ä»Šã¾ã§å—ã‘ãŸæœ€ã‚‚æ¥ãšã‹ã—ã„ä½“é¨“ã‚’å‘Šç™½ã™ã‚‹ã€‚",
"ç”·å­ç½°21.ç¾åœ¨ã®ä¸‹åŠèº«ã‚’å†™çœŸã«å–ã‚Šã€æºå¸¯ã«3æ—¥ä¿ç®¡ã™ã‚‹",
"ç”·å­ç½°22.å‹åˆ©è€…ã‹ã‚‰å¥½ããªç®‡æ‰€ã«è½æ›¸ãã‚’1ã¤ã—ã¦å†™çœŸã‚’æ’®ã‚Šãƒ­ãƒƒã‚¯ç”»é¢ã«3æ—¥ã™ã‚‹ã€‚",
"ç”·å­ç½°23.å‹åˆ©è€…ã‹ã‚‰å¥½ããªç®‡æ‰€ã«è½æ›¸ãã‚’1ã¤ã—ã¦ãƒ©ã‚¤ãƒ³orã‚«ã‚«ã‚ªã®ç•°æ€§ã«1äººã«ã€Œä»Šã®å§¿ã‚’èª¬æ˜ã—ã©ã†æ€ã†ï¼Ÿã€ã¨é€ã‚‹ã€‚å‡ºæ¥ãªã„å ´åˆã¯å‹åˆ©è€…ãŒãƒ•ãƒªãƒ¼å‘½ä»¤ã€‚",
"ç”·å­ç½°24.ãƒ©ã‚¤ãƒ³orã‚«ã‚«ã‚ªã®ç•°æ€§ã«1äººã«ã€Œç§ã«ã‚¨ãƒƒãƒãªå‘½ä»¤ã—ã¦ã€ã¨é€ã‚‹ã€‚å‡ºæ¥ãªã„å ´åˆã¯å‹åˆ©è€…ãŒãƒ•ãƒªãƒ¼å‘½ä»¤ã€‚",
"ç”·å­ç½°25.HNã‚’å‹åˆ©è€…ã®æŒ‡å®šã™ã‚‹åå‰ã«å¤‰ãˆã‚‹ãã—ã¦ã€ãƒ©ã‚¤ãƒ³orã‚«ã‚«ã‚ªã®åå‰ã‚’ç¾çŠ¶ã®åå‰ã«çµ‚ã‚ã‚‹ã¾ã§å¤‰ãˆã‚‹ã€‚å‡ºæ¥ãªã„å ´åˆã¯å‹åˆ©è€…ãŒãƒ•ãƒªãƒ¼å‘½ä»¤ã€‚ï¼ˆä¾‹ï¼šé›‘é­šãƒãƒ³ã‚³åå‰ï¼‰",
"ç”·å­ç½°26.HNã‚’å‹åˆ©è€…ã®æŒ‡å®šã™ã‚‹åå‰ã«å¤‰ãˆã‚‹ã€‚ãƒ«ãƒ–ãƒ«ã«ã‚‚ãã®åå‰ã§ãƒ­ã‚°ã‚¤ãƒ³ã—å‹è€…ã®æŒ‡å®šã—ãŸè¨€è‘‰ã‚’ã¤ã¶ã‚„ã",
"ç”·å­ç½°27.å®Ÿæ³ã—ãªãŒã‚‰å¯¸æ­¢ã‚ã‚ªãƒŠãƒ‹ãƒ¼ï¼ˆä¿ç•™å¯ï¼‰",
"ç”·å­ç½°28.å®Ÿæ³ã—ãªãŒã‚‰ã‚¤ã‚¯ã¾ã§ã‚ªãƒŠãƒ‹ãƒ¼(ä¿ç•™å¯)",
"ç”·å­ç½°29.ã€åœ°ç„ã€‘å¥³æ€§åŒ–èª¿æ•™ã€‚å‹è€…ã«å¥³æ€§ã¨ã—ã¦ã®åå‰ã€åå‰ã®è‰²ã‚’ã¤ã‘ã¦ã‚‚ã‚‰ã†ã€‚ä¸€äººç§°ã¯ã€Œã‚ãŸã—ã€ã§ç”·è¨€è‘‰ä½¿ç”¨ç¦æ­¢ã€å¥³ã«ãªã‚Šãã£ã¦ãƒãƒ£ãƒƒãƒˆã™ã‚‹ã“ã¨ã€‚å¥³æ€§ç”¨ã‚·ãƒ§ãƒ¼ãƒ„ã¨ãƒ‘ãƒ³ã‚¹ãƒˆã€å®¶ã§ã¯ãƒ–ãƒ©ã‚„ãƒ‘ãƒƒãƒ‰ã€ã‚¹ã‚«ãƒ¼ãƒˆã‚‚æ‰‹ã«å…¥ã‚‹å ´åˆã¯èº«ã«ã¤ã‘ã‚‹ã€‚ä¸‹ç€ç¦æ­¢ã‚„è„±è¡£å‘½ä»¤ãŒå‡ºã¦ã‚‚è„±ãã®ã¯ç¦æ­¢ã€‚ãŠã¡ã‚“ã½ã¯ã‚¯ãƒªã€ã‚¢ãƒŠãƒ«ã¯ãŠã¾ã‚“ã“ã¨å‘¼ç§°ã™ã‚‹ã€‚ã‚ªãƒŠãƒ‹ãƒ¼ã™ã‚‹å ´åˆã¯æ™®é€šã«ã—ã”ãç”·ã¨ã—ã¦ã®ã‚ªãƒŠãƒ‹ãƒ¼ã‚’ç¦æ­¢ã—ã€å¥³æ€§ã®ã‚¯ãƒªã‚ªãƒŠã®ã‚ˆã†ã«æ’«ã§ã‚‹ã‚ˆã†ã«ã‚·ãƒ§ãƒ¼ãƒ„ã®ä¸Šã‹ã‚‰å–˜ããªãŒã‚‰è¡Œã†ã“ã¨ã€‚æœŸé–“ã¯æ¬¡ã«å‹è² ã«å‹ã¤ã¾ã§ã¨ã™ã‚‹ã€‚",
"ç”·å­ç½°30.ã€åœ°ç„ã€‘å‹åˆ©è€…ã®å¥´éš·ã«3æ—¥ãªã‚‹ã€‚",
];

const specialPainPunishItems = [
"è‹¦ç—›ç½°1.ä¹³é¦–ã«æ´—æ¿¯ãƒã‚µãƒŸã‚’ã¤ã‘ã€1åˆ†é–“ã²ã£ã±ã‚ŠãªãŒã‚‰å·¦å³ã«æ»ã‚‹ã€‚",
"è‹¦ç—›ç½°2.ä¹³é¦–ã«æ´—æ¿¯ãƒã‚µãƒŸã‚’ã¤ã‘ã€æ´—æ¿¯ãƒã‚µãƒŸã‚’é–‹ã‹ãšã«ç„¡ç†ã‚„ã‚Šå–ã‚‹ã€‚",
"è‹¦ç—›ç½°3.ä¹³é¦–ã«æ´—æ¿¯ãƒã‚µãƒŸã‚’ã¤ã‘ã€å©ããŠã¨ã™ã€‚",
"è‹¦ç—›ç½°4.ãŠå°»ã«ä»Šã¾ã§å…¥ã‚ŒãŸã“ã¨ãªã„ã‚‚ã®ã‚’å…¥ã‚Œã‚‹ã€‚",
"è‹¦ç—›ç½°5.æ­¯ç£¨ãç²‰ã‚’ã¤ã‘ãŸæ­¯ãƒ–ãƒ©ã‚·ã§ä¹³é¦–ã‚’ç£¨ãã€‚",
"è‹¦ç—›ç½°6.æ­¯ç£¨ãç²‰ã‚’ã¤ã‘ãŸæ­¯ãƒ–ãƒ©ã‚·ã§ã‚¯ãƒªã‚’ç£¨ãã€‚",
"è‹¦ç—›ç½°7.æ­¯ç£¨ãç²‰ã‚’ã¤ã‘ãŸæ­¯ãƒ–ãƒ©ã‚·ã§ã‚ªãƒãƒ³ã‚³ã‚’ç£¨ãã€‚",
"è‹¦ç—›ç½°8.ã‚ªãƒãƒ³ã‚³ã‚’å…¨åŠ›ã§10å›å©ãã€‚",
"è‹¦ç—›ç½°9.å³ã®ãŠå°»ã‚’å…¨åŠ›ã§10å›å©ãã€‚",
"è‹¦ç—›ç½°10.ã‚¹ãƒªãƒƒãƒ‘ã§å³ã®ãŠå°»ã‚’å…¨åŠ›ã§10å›å©ãã€‚",
"è‹¦ç—›ç½°11.ãŠå°»ã«ãƒã‚¤ãƒ–ã‹ãƒ­ãƒ¼ã‚¿ãƒ¼ã‚’å…¥ã‚Œã¦å¼·ã«ã—ãŸã¾ã¾å››ã¤ã‚“é€™ã„ã«ãªã‚ŠèˆŒã‚’å‡ºã—ãŸã¾ã¾ãŠå®¶ã‚’1å‘¨ã™ã‚‹ã€‚",
"è‹¦ç—›ç½°12.ä¹³é¦–ã‚’å£ã«ã¤ã‘ãŸçŠ¶æ…‹ã§éƒ¨å±‹ã‚’1å‘¨å‘¨ã‚‹ã€‚",
"è‹¦ç—›ç½°13.ã‚ªãƒãƒ³ã‚³ã«ãƒã‚¤ãƒ–ã‹ãƒ‡ã‚£ãƒ«ãƒ‰ã‚’å…¥ã‚Œã¦æŠœã‘ãªã„ã‚ˆã†ã«ãƒ‘ãƒ³ãƒ„ã‚’å±¥ãå…¨åŠ›ã§æŠ¼ã—è¾¼ã‚€ã‚ˆã†ã«10å›å©ãã€‚",
"è‹¦ç—›ç½°14.ã‚ªãƒãƒ³ã‚³ã«ãƒã‚¤ãƒ–ã‹ãƒ‡ã‚£ãƒ«ãƒ‰ã‚’å…¥ã‚Œã¦æŠœã‘ãªã„ã‚ˆã†ã«ãƒ‘ãƒ³ãƒ„ã‚’å±¥ãè†ç«‹ã¡ã«ãªã‚Šã€ãã“ã‹ã‚‰å‹¢ã„ã‚ˆãåº§ã‚Šå¥¥ã¾ã§ãƒã‚¤ãƒ–ã‚’æŠ¼ã—è¾¼ã‚€ã‚’10å›ã™ã‚‹ã€‚",
"è‹¦ç—›ç½°15.ã€æŒç¶šã€‘ä¹³é¦–ã«æ´—æ¿¯ãƒã‚µãƒŸã‚’ã¤ã‘ãŸã¾ã¾ç½°ã‚’è¡Œã†ã€‚",
"è‹¦ç—›ç½°16.ã€æŒç¶šã€‘ç©å…·ã¾ãŸã¯ãƒšãƒ³ãªã©ã‚’ã‚ªãƒãƒ³ã‚³ã¨ãŠå°»ã«ã„ã‚ŒãŸã¾ã¾ç½°ã‚’è¡Œã†ã€‚",
"è‹¦ç—›ç½°17.ã€æŒç¶šã€‘å‰²ã‚‹å‰ã®å‰²ã‚Šç®¸ã®é–“ã«ä¹³é¦–ã‹èˆŒã‚’æŒŸã¿ç©ºã„ã¦ã‚‹å´ã‚’è¼ªã‚´ãƒ ã§ç· ã‚ãŸçŠ¶æ…‹ã§ç½°ã‚’è¡Œã†ã€‚",
"è‹¦ç—›ç½°18.ã€æŒç¶šã€‘ã“ã‚Œä»¥é™ç©ºã„ã¦ã‚‹æ™‚é–“ã¯å¸¸ã«ã‚¯ãƒªã‚’åˆºæ¿€ã—ãªãŒã‚‰ç½°ã‚’è¡Œã†ã€‚",
"è‹¦ç—›ç½°19.ä¹³é¦–ã¨ã‚¯ãƒªã«åˆºæ¿€ç‰©ã‚’å¡—ã‚‹ã€‚",
"è‹¦ç—›ç½°20.ãŠã¾ã‚“ã“ã«åˆºæ¿€ç‰©ã‚’å¡—ã‚‹",
];

function shuffle(a){ return a.sort(()=>Math.random()-0.5); }
let punishStockByRoom = {};

function initPunishRoom(room){
  if (!punishStockByRoom[room]) {
    punishStockByRoom[room] = {
      girl: shuffle([...punishItems]),
      boy: shuffle([...boyPunishItems]),
      pain: shuffle([...specialPainPunishItems])
    };
  }
}
function getGirlPunish(room){
  initPunishRoom(room);
  if (!punishStockByRoom[room].girl.length)
    punishStockByRoom[room].girl = shuffle([...punishItems]);
  return punishStockByRoom[room].girl.shift();
}
function getBoyPunish(room){
  initPunishRoom(room);
  if (!punishStockByRoom[room].boy.length)
    punishStockByRoom[room].boy = shuffle([...boyPunishItems]);
  return punishStockByRoom[room].boy.shift();
}
function getPainPunish(room){
  initPunishRoom(room);
  if (!punishStockByRoom[room].pain.length)
    punishStockByRoom[room].pain = shuffle([...specialPainPunishItems]);
  return punishStockByRoom[room].pain.shift();
}

/* ===============================
   15åˆ†ç„¡åå¿œåˆ‡æ–­ï¼ˆå¾©æ—§ï¼‰
================================ */
const LIMIT = 15 * 60 * 1000;
function updateActive(socket){
  const u = users.find(x=>x.id===socket.id);
  if(u) u.lastActive = Date.now();
}
setInterval(()=>{
  const now = Date.now();
  users.forEach(u=>{
    if(now - (u.lastActive ?? now) > LIMIT){
      const s = io.sockets.sockets.get(u.id);
      if(s){
        s.emit("message", {
          name:"system",
          text:"15åˆ†é–“åå¿œãŒãªã‹ã£ãŸãŸã‚åˆ‡æ–­ã•ã‚Œã¾ã—ãŸ",
          room:u.room,
          time:getTimeString()
        });
        s.disconnect(true);
      }
    }
  });
}, 60000);

/* ===============================
   âš¡ é›»æ°—æ¤…å­ï¼ˆè¿½åŠ åˆ†ã ã‘ï¼‰
================================ */
const DENKI_ROOM = "denki";
let denki = {
  players: [],
  turn: 0,
  phase: "set",
  trapSeat: null
};

function denkiState(){
  return {
    phase: denki.phase,
    players: denki.players.map((p,i)=>({
      id:p.id,
      name:p.name,
      score:p.score,
      shock:p.shock,
      isTurn: denki.turn===i
    }))
  };
}
function resetDenki(){
  denki.phase="set";
  denki.trapSeat=null;
}

/* ===============================
   Socket.IO
================================ */
io.on("connection", socket => {

  socket.on("checkRoomKey", ({ room, key }) => {
    if (roomKeys[room] && key !== roomKeys[room]) {
      socket.emit("checkResult", { ok:false, message:"éµãŒé•ã„ã¾ã™" });
      return;
    }
    const privateRooms = ["privateA","privateB","privateC","privateD"];
    if (privateRooms.includes(room)) {
      const r = io.sockets.adapter.rooms.get(room);
      if (r && r.size >= 2) {
        socket.emit("checkResult", { ok:false, message:"ã“ã®å€‹å®¤ã¯æº€å®¤ã§ã™" });
        return;
      }
    }
    socket.emit("checkResult", { ok:true });
  });

  socket.on("join", ({ name, color="black", room="room1" }) => {
    socket.username = name;
    socket.room = room;
    socket.join(room);

    users.push({ id:socket.id, name, color, room, lastActive:Date.now() });

    io.to(room).emit("userList", users.filter(u=>u.room===room));
    socket.emit("pastMessages", messagesLog.filter(m=>m.room===room));
    io.emit("lobbyUpdate", getLobbyInfo());

    if (room === DENKI_ROOM && denki.players.length < 2) {
      denki.players.push({ id:socket.id, name, score:0, shock:0 });
      io.to(DENKI_ROOM).emit("denkiState", denkiState());
    }
  });

  socket.on("denkiSet", seat=>{
    if(socket.room!==DENKI_ROOM) return;
    const me = denki.players[denki.turn];
    if(!me || me.id!==socket.id || denki.phase!=="set") return;
    denki.trapSeat = seat;
    denki.phase = "sit";
    io.to(DENKI_ROOM).emit("denkiState", denkiState());
  });

  socket.on("denkiSit", seat=>{
    if(socket.room!==DENKI_ROOM || denki.phase!=="sit") return;
    const victim = denki.players.find(p=>p.id!==denki.players[denki.turn].id);
    if(!victim || victim.id!==socket.id) return;

    let text, color;
    if(seat===denki.trapSeat){
      victim.score = 0;
      victim.shock += 1;
      text = `âš¡ é›»æµï¼${victim.name} ã¯0ç‚¹`;
      color = "red";
    } else {
      victim.score += seat;
      text = `ğŸ˜Œ ã‚»ãƒ¼ãƒ•ï¼${victim.name} ã¯${seat}ç‚¹`;
      color = "green";
    }

    const msg={name:"system",text,color,room:DENKI_ROOM,time:getTimeString()};
    messagesLog.push(msg); saveLogs();
    io.to(DENKI_ROOM).emit("message",msg);

    denki.turn = 1-denki.turn;
    resetDenki();
    io.to(DENKI_ROOM).emit("denkiState", denkiState());
  });

  socket.on("message", data=>{
    updateActive(socket);
    const text=(data.text??"").trim();
    if(!text) return;

    const m=text.match(/^(\d+)d(\d+)(?:\+(\d+))?$/i);
    if(m){
      const c=Math.min(+m[1],20), f=Math.min(+m[2],10000), p=+(m[3]||0);
      const r=Array.from({length:c},()=>Math.floor(Math.random()*f)+1);
      const msg={
        name:socket.username,
        text:`${c}d${f}${p?`+${p}`:""} â†’ï¼ˆ${r.join(",")}ï¼‰ï¼${r.reduce((a,b)=>a+b,0)+p}`,
        room:socket.room,
        time:getTimeString()
      };
      messagesLog.push(msg); saveLogs();
      io.to(socket.room).emit("message",msg);
      return;
    }

    if(text==="å¥³å­ç½°"){
      const msg={name:"system",text:getGirlPunish(socket.room),color:"red",room:socket.room,time:getTimeString()};
      messagesLog.push(msg); saveLogs(); io.to(socket.room).emit("message",msg); return;
    }
    if(text==="ç”·å­ç½°"){
      const msg={name:"system",text:getBoyPunish(socket.room),color:"blue",room:socket.room,time:getTimeString()};
      messagesLog.push(msg); saveLogs(); io.to(socket.room).emit("message",msg); return;
    }
    if(text==="è‹¦ç—›ç½°" && socket.room==="special"){
      const msg={name:"system",text:getPainPunish(socket.room),color:"purple",room:socket.room,time:getTimeString()};
      messagesLog.push(msg); saveLogs(); io.to(socket.room).emit("message",msg); return;
    }

    if(data.to){
      const msg={name:socket.username,text,room:socket.room,time:getTimeString(),private:true,to:data.to};
      messagesLog.push(msg); saveLogs();
      socket.emit("message",msg);
      io.to(data.to).emit("message",msg);
      return;
    }

    const msg={name:socket.username,text,room:socket.room,time:getTimeString()};
    messagesLog.push(msg); saveLogs();
    io.to(socket.room).emit("message",msg);
  });

  socket.on("leave",()=>socket.disconnect(true));
  socket.on("disconnect",()=>{
    users = users.filter(u=>u.id!==socket.id);
    denki.players = denki.players.filter(p=>p.id!==socket.id);
    io.emit("lobbyUpdate", getLobbyInfo());
  });
});

const PORT = process.env.PORT || 3000;
server.listen(PORT, ()=>console.log(`Server running on ${PORT}`));
