<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Chat v2 - sugoroku</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  margin: 0;
  font-family:
    -apple-system,
    BlinkMacSystemFont,
    "Segoe UI",
    "Hiragino Kaku Gothic ProN",
    "Hiragino Sans",
    "Noto Sans JP",
    Meiryo,
    sans-serif;
  height: 100vh;
  display: flex;
  flex-direction: column;
}


#login, #chat { flex: 1; display: flex; flex-direction: column; }
#chat { display: none; }

.system { color: gray; }
.system.girl { color: red; font-weight: bold; }
.system.boy { color: blue; font-weight: bold; }

#controls { display: flex; gap: 5px; padding: 5px; position: sticky; top: 0; background: #fff; z-index: 10; }
input, button, select { padding: 10px; font-size: 16px; }
#punishWrap {
  gap: 20px;   /* ãƒœã‚¿ãƒ³åŒå£«ã®é–“éš” */

  position: absolute;
  bottom: 100%;
  left: 0;
  right: 0;

  background: #fff;
  padding: 8px;
  z-index: 200;
}
#punishWrap button {
  padding: 6px 12px;  /* ãƒœã‚¿ãƒ³ã®ä¸­ã®ä½™ç™½ */
  font-size: 16px;   /* æ–‡å­—ã‚µã‚¤ã‚º */
}


#userList {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  background: #f0f0f0;
  padding: 5px;
  list-style: none;
  align-items: center;
}

#userList li {
  padding: 3px 8px;
  border-radius: 5px;
  white-space: nowrap;
}


#settings { display: flex; gap: 5px; align-items: center; flex-wrap: wrap; padding: 5px; background: #f9f9f9; border-bottom: 1px solid #ccc; }
#settings input, #settings button, #settings select { padding: 5px; font-size: 14px; }

#messages {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  padding: 10px;
  list-style: none;
  padding-bottom: 260px;
}
#messages li { margin-bottom: 5px; }
.private { background: #fff3cd; padding: 3px 6px; border-radius: 4px; }

.time { opacity: .6; margin-right: 4px; }

</style>
</head>
<body>

<div id="login">
  <h2>å…¥å®¤</h2>

  <div id="roomInfo"
       style="margin-bottom:10px; color:#555;">
  </div>

  <!-- ===== ãƒ«ãƒ¼ãƒ«èª¬æ˜ ===== -->
<div style="
  margin-top:14px;
  padding:10px;
  font-size:13px;
  line-height:1.6;
  background:#f5f5f5;
  border:1px solid #ccc;
">

<strong>åˆ©ç”¨ãƒ«ãƒ¼ãƒ«</strong><br><br>

<div id="roomDesc"
     style="
       margin-bottom:12px;
       white-space:pre-wrap;
       font-size:13px;
       line-height:1.6;
     ">
</div>

</div>


  <input id="nameInput"
         placeholder="åå‰">

  <!-- ===== ç¢ºèªãƒã‚§ãƒƒã‚¯ ===== -->
  <div style="
    margin-top:12px;
    font-size:14px;
    line-height:1.6;
  ">

    <label>
      <input type="checkbox"
             id="confirmAge">
      18æ­³æœªæº€ã®åˆ©ç”¨ã¯ç¦æ­¢ã§ã™
    </label>
    <br>

    <label>
      <input type="checkbox"
             id="confirmRule">
      ãƒ«ãƒ¼ãƒ«ãƒ»ç¦æ­¢äº‹é …ã‚’ç¢ºèªã—ã¾ã—ãŸ
    </label>
    <br>

    <label>
      <input type="checkbox"
             id="confirmIp">
      IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ä¿ç®¡ã•ã‚Œã€
      å•é¡Œç™ºç”Ÿæ™‚ã¯é–‹ç¤ºã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™
    </label>


  </div>

  <button id="joinBtn"
          style="margin-top:12px;">
    å…¥å®¤
  </button>
</div>

<div id="chat">
 <div id="controls">
  <input id="input" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸">
  <button id="sendBtn">é€ä¿¡</button>

  <span id="roomLabel"
    style="padding:10px; font-weight:bold;">
  </span>
</div>

<!-- ===== ã™ã”ã‚ããƒ€ã‚¤ã‚¹ ===== -->
<div id="sugorokuDice" style="
  padding:8px;
  display:flex;
  gap:8px;
  align-items:center;
">
  <button onclick="rollDice(6)">1d6</button>
  <button onclick="rollDice(5)">1d5</button>
  <button onclick="rollDice(4)">1d4</button>
  <button onclick="rollDice(3)">1d3</button>
  <button onclick="rollDice(2)">1d2</button>

  <button id="luckBtn" onclick="tryLuck()" style="display:none;">
    é‹è©¦ã—
  </button>

  <button id="specialDiceBtn" style="display:none;">
    2d6
  </button>
</div>

<!-- ===== ã‚¿ã‚¤ãƒãƒ¼ ===== -->
<div id="timerBox" style="
  padding:8px;
  display:flex;
  gap:8px;
  align-items:center;
  border-top:1px solid #ccc;
">

  <button id="timer3Btn">3åˆ†</button>
  <button id="timer5Btn">5åˆ†</button>

  <input id="timerCustomInput"
    placeholder="åˆ†"
    style="width:60px;">

  <button id="timerCustomBtn">ä»»æ„</button>

</div>



<!-- ===== å‚åŠ è€… ===== -->
<div style="display:flex; align-items:center; gap:8px; flex-wrap:wrap;">
  <strong>å‚åŠ è€…:</strong>
  <ul id="userList"></ul>
</div>



<div id="timerDisplay"
     style="
       font-weight:bold;
       padding:4px 0;
       display:none;">
  â± 00:00
</div>

<div id="settings">

  <button id="zecchoBtn" style="display:none; background:black; color:white; padding:8px 12px; border-radius:6px;">
  çµ¶é ‚è¨±å¯
</button>

    <label>è‰²: <input type="color" id="colorSelect" value="#000000"></label>
    <label>å†…ç·’:
      <select id="privateTarget">
        <option value="">ãªã—</option>
      </select>
    </label>
    <label>
      éŸ³:
      <select id="soundSelect">
        <option value="off">OFF</option>
        <option value="small">å°</option>
        <option value="medium">ä¸­</option>
        <option value="large">å¤§</option>
      </select>
    </label>
    <button id="ruleBtn">èª¬æ˜</button>
    <button id="leaveBtn">é€€å‡º</button>
  </div>

  <ul id="messages"></ul>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();

const login = document.getElementById("login");
const chat = document.getElementById("chat");
const joinBtn = document.getElementById("joinBtn");
const nameInput = document.getElementById("nameInput");
const roomInfo = document.getElementById("roomInfo");

const messages = document.getElementById("messages");
const input = document.getElementById("input");
const sendBtn = document.getElementById("sendBtn");
const leaveBtn = document.getElementById("leaveBtn");
const userList = document.getElementById("userList");
const colorSelect = document.getElementById("colorSelect");
const privateTarget = document.getElementById("privateTarget");
const soundSelect = document.getElementById("soundSelect");

const notifySound = new Audio("/notify.mp3");
const SOUND_LEVELS = { off:0, small:0.2, medium:0.5, large:1.0 };
let soundLevel = localStorage.getItem("soundLevel") || "off";
soundSelect.value = soundLevel;

let username = "";
let myColor = "#000000";
let privateTo = "";
let joined = false;






window.addEventListener("load", () => {
  const savedName  = localStorage.getItem("chatName");
  const savedRoom  = localStorage.getItem("chatRoom");
  const savedColor = localStorage.getItem("chatColor") || "#000000";

  if (savedName && savedRoom) {
    username = savedName;
    myColor = savedColor;
    colorSelect.value = myColor;
    

  socket.emit("join", {
  name: username,
  color: myColor,
  room: savedRoom,
  connectKey: localStorage.getItem("connectKey")
});

    joined = true;
    

        // ===== åˆå›ç¢ºèªæ¸ˆã¿ãªã‚‰ãƒã‚§ãƒƒã‚¯éè¡¨ç¤º =====
    const confirmed =
      localStorage.getItem(
        "entryConfirmed"
      );

    if (confirmed){
      const loginDiv =
        document.getElementById("login");

      if (loginDiv){
        loginDiv.style.display =
          "none";
      }
    }

    login.style.display = "none";
    chat.style.display = "flex";
  }
});

/* ===== ãƒ­ãƒ“ãƒ¼ã‹ã‚‰ã®æƒ…å ± ===== */
const room = localStorage.getItem("chatRoom");

const descEl =
  document.getElementById("roomDesc");


if (
  room === "sugoroku1" ||
  room === "sugoroku2" ||
  room === "sugoroku3"
) {
descEl.innerHTML =
`ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯
ã€Œåå‰ï¼‹æ€§åˆ¥ï¼‹Mã€ã§å…¥å®¤ã™ã‚‹ã“ã¨

ã€é‡è¦ã€‘
è¦‹å­¦è€…ã¯ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«å¯¾ã—ã¦
ãƒ»ã‚ªãƒŠãƒ‹ãƒ¼æ–¹æ³•
ãƒ»å¯¸æ­¢ã‚æ–¹æ³•
ãƒ»ä½“å‹¢
ãªã©ã®æŒ‡ç¤ºã‚’å‡ºã™ã“ã¨ãŒã§ãã‚‹

ã€éŠã³æ–¹ã€‘
ã‚³ãƒ¼ã‚¹ã‚’é¸ã¶

A. æ°—è»½ã‚³ãƒ¼ã‚¹
â†’ Mã¯1d6ã®ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚Œã‚‹

B. æ™®é€šã‚³ãƒ¼ã‚¹
â†’ Mã¯1d5ã®ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚Œã‚‹

C. çµ¶æœ›ã‚³ãƒ¼ã‚¹
â†’ Mã¯1d4ã®ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚Œã‚‹

Z. è£é“ã‚³ãƒ¼ã‚¹
â†’ Mã¯1d3ã®ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚Œã‚‹


ã•ã‚‰ã«ä»¥ä¸‹ãŒå¸¸æ™‚é©ç”¨ã•ã‚Œã‚‹ï¼š

âœ§ ç©ºã„ã¦ã„ã‚‹æ™‚é–“ã¯ä¹³é¦–ã‚’ã„ã˜ã‚ç¶šã‘ã‚‹
âœ§ å¯¸æ­¢ã‚ã¯ã€Œæ­¢ã‚ã‚ˆã†ã¨æ€ã£ã¦ã‹ã‚‰10å›ã€æ‰‹ã‚’æ­¢ã‚ãšã«ç¶šã‘ã‚‹

ã‚´ãƒ¼ãƒ«ã§ããªã‹ã£ãŸå ´åˆ
â†’ å¾Œæ—¥ã‚„ã‚Šç›´ã™ã“ã¨

å…¨å“¡ã«å¯¾ã—ã¦
ãƒ»è‡ªåˆ†ä»¥å¤–ã¯ã€Œæ§˜ä»˜ã‘ï¼‹æ•¬èªã€ã§è©±ã™
ãƒ»æŒ‡ç¤ºã•ã‚ŒãŸã‚‰æ„Ÿè¬ã™ã‚‹ã“ã¨

å®Ÿè¡Œä¸­ã¯
ãƒ»å®Ÿæ³ã—ã¦å‘¨ã‚Šã‚’æ¥½ã—ã¾ã›ã‚‹ã“ã¨

çµ¶é ‚ã™ã‚‹å ´åˆ
â†’ã€Œã‚¤ã‚«ã›ã¦ãã ã•ã„ã€ã¨æ‡‡é¡˜ã—è¨±å¯ã‚’å¾—ã‚‹
â†’ èª°ã‚‚ã„ãªã„å ´åˆã¯30ç§’æˆ‘æ…¢å¾Œã€Œã‚¤ã‚­ã¾ã™ã€ã¨è¨€ã£ã¦çµ¶é ‚

çµ¶é ‚ã—ã¦ã—ã¾ã£ãŸå ´åˆ
â†’ ãã®å‘½ä»¤ã¯çµ‚äº†
`;
}  



/* ===== å…¨éƒ¨å±‹å…±é€šï¼šæ–‡å­—è‰² ===== */
descEl.style.color = "black";



const roomLabel = document.getElementById("roomLabel");

if (roomLabel && room) {
  roomLabel.textContent = room;
}


const key = localStorage.getItem("chatKey");


if (!room && !joined) {
  alert("ãƒ­ãƒ“ãƒ¼ã‹ã‚‰å…¥å®¤ã—ã¦ãã ã•ã„");

}
if (room) roomInfo.textContent = `å…¥å®¤å…ˆï¼š${room}`;

/* ===== è¡¨ç¤º ===== */
function renderMsg(d) {
  const li = document.createElement("li");

  if (d.time) {
    const t = document.createElement("span");
    t.textContent = `[${d.time}] `;
    t.className = "time";
    li.appendChild(t);
  }

  const text = document.createElement("span");
  if (d.private) {
    const toName = d.toName || "ç›¸æ‰‹";
    text.textContent = `ã€å†…ç·’ã€‘${d.name} â–¶ ${toName}: ${d.text}`;
    li.classList.add("private");
  } else {
    text.textContent = `${d.name}: ${d.text}`;
  }

 li.appendChild(text);
li.style.color = d.color || "#000";

if (d.bold) {
  text.style.fontWeight = "bold";
}

messages.prepend(li);

}

/* ===== å—ä¿¡ ===== */
socket.on("connect", () => {

  myId = socket.id;


});

socket.on("pastMessages", logs => {

  messages.innerHTML = "";
  logs.forEach(renderMsg);


});

// ===== å€‹äººãƒŸãƒ¥ãƒ¼ãƒˆç®¡ç† =====
let myMutes = [];

// server ã‹ã‚‰åŒæœŸï¼ˆå¾Œã§æ‹¡å¼µç”¨ï¼‰
socket.on("muteSync", list => {
  myMutes = list || [];
});

socket.on("message", d => {

// ===== ãƒŸãƒ¥ãƒ¼ãƒˆé®æ–­ =====
if (d.name && myMutes.includes(d.name)) {
  return;
}


  // ===== å†…ç·’è¡¨ç¤ºåˆ¶å¾¡ =====
  if (d.private) {
    if (d.to !== myId && d.name !== username) return;
  }

  // ===== é€šçŸ¥éŸ³ =====
  if (
    soundLevel !== "off" &&
    d.name &&
    d.name !== username
  ) {
    notifySound.volume =
      SOUND_LEVELS[soundLevel];

    notifySound.currentTime = 0;
    notifySound.play().catch(()=>{});
  }

  renderMsg(d);

});

socket.on("zecchoUnlock", () => {

  const btn = document.getElementById("zecchoBtn");

  if (btn){
    btn.style.display = "inline-block";
  }

});
// ===== ã‚¿ã‚¤ãƒãƒ¼åŒæœŸ =====
let timerInterval = null;

socket.on("timerSync", ({ endTime }) => {

  const display =
    document.getElementById("timerDisplay");

  if (!display) return;

  display.style.display = "block";

  if (timerInterval){
    clearInterval(timerInterval);
  }

  timerInterval = setInterval(() => {

    const remain =
      Math.max(0, endTime - Date.now());

    const sec =
      Math.floor(remain / 1000);

    const m =
      String(Math.floor(sec / 60))
        .padStart(2,"0");

    const s =
      String(sec % 60)
        .padStart(2,"0");

    display.textContent =
      `â± ${m}:${s}`;

    if (remain <= 0){
      clearInterval(timerInterval);
    }

  }, 1000);

});

// ===== ã‚¿ã‚¤ãƒãƒ¼çµ‚äº† =====
socket.on("timerEnd", () => {

  const display =
    document.getElementById("timerDisplay");

  if (display){
    display.style.display = "none";
  }

  if (timerInterval){
    clearInterval(timerInterval);
  }

});

socket.on("zecchoHide", () => {

  const btn =
    document.getElementById("zecchoBtn");

  if (btn){
    btn.style.display = "none";
  }

});




socket.on("userList", list => {

  userList.innerHTML = "";
  privateTarget.innerHTML =
    `<option value="">ãªã—</option>`;

  list.forEach(u => {

    const li = document.createElement("li");

const nameSpan = document.createElement("span");

nameSpan.textContent =
  (u.isAdmin ? "ğŸ‘‘" : "") + u.name;

nameSpan.style.color =
  u.color || "#000";

li.appendChild(nameSpan);

    // ===== è‡ªåˆ†ä»¥å¤–ã®ã¿æ“ä½œãƒœã‚¿ãƒ³ =====
    if (u.id !== myId) {

      // å†…ç·’ç”¨
      const opt =
        document.createElement("option");

      opt.value = u.id;
      opt.textContent = u.name;

      privateTarget.appendChild(opt);

    
   // ===== ãƒŸãƒ¥ãƒ¼ãƒˆãƒœã‚¿ãƒ³ =====
const muteBtn =
  document.createElement("button");

// åˆæœŸè¡¨ç¤º
if (myMutes.includes(u.name)) {
  muteBtn.textContent = "æ¸ˆ";
} else {
  muteBtn.textContent = "æ¶ˆ";
}

muteBtn.style.marginLeft = "6px";
muteBtn.style.padding = "2px 6px";
muteBtn.style.fontSize = "12px";
muteBtn.style.lineHeight = "1.2";

muteBtn.onclick = () => {

  socket.emit("muteUser", u.id);

  // è¡¨ç¤ºãƒˆã‚°ãƒ«
  if (muteBtn.textContent === "æ¶ˆ") {
    muteBtn.textContent = "æ¸ˆ";
  } else {
    muteBtn.textContent = "æ¶ˆ";
  }

};


      li.appendChild(muteBtn);
    }

    userList.appendChild(li);

  });

});


// ===== æ¥ç¶šã‚­ãƒ¼ç”Ÿæˆ =====
let connectKey =
  localStorage.getItem("connectKey");

if (!connectKey){

  connectKey =
    Math.random().toString(36).slice(2) +
    Date.now().toString(36);

  localStorage.setItem(
    "connectKey",
    connectKey
  );

}

/* ===== å…¥å®¤å‡¦ç† ===== */
joinBtn.onclick = () => {

const room = localStorage.getItem("chatRoom");

if (!room) {
  alert("ãƒ­ãƒ“ãƒ¼ã‹ã‚‰å…¥å®¤ã—ã¦ãã ã•ã„");
  return;
}

  if (joined || !nameInput.value.trim()) return;

    // ===== ç¢ºèªãƒã‚§ãƒƒã‚¯åˆ¤å®š =====
  const ageCheck =
    document.getElementById("confirmAge");

  const ruleCheck =
    document.getElementById("confirmRule");

  const ipCheck =
    document.getElementById("confirmIp");

  const confirmed =
    localStorage.getItem(
      "entryConfirmed"
    );

  // åˆå›ã®ã¿å¿…é ˆ
  if (!confirmed) {

    if (
      !ageCheck?.checked ||
      !ruleCheck?.checked ||
      !ipCheck?.checked
    ){
      alert(
        "ç¢ºèªé …ç›®ã‚’ã™ã¹ã¦ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„"
      );
      return;
    }

    localStorage.setItem(
      "entryConfirmed",
      "true"
    );
  }


  username = nameInput.value.trim();
  localStorage.setItem("chatName", username);

  socket.emit("join", {
  name: username,
  color: myColor,
  room,
  key,
  connectKey
});


  joined = true;
  login.style.display = "none";
  chat.style.display = "flex";
};

/* ===== æ“ä½œ ===== */
colorSelect.oninput = () => {
  myColor = colorSelect.value;
  localStorage.setItem("chatColor", myColor);
  socket.emit("updateColor", { color: myColor });
};

soundSelect.onchange = () => {
  soundLevel = soundSelect.value;
  localStorage.setItem("soundLevel", soundLevel);
};

privateTarget.onchange = () => {
  privateTo = privateTarget.value || "";
};

sendBtn.onclick = () => {
  if (!input.value.trim()) return;
  socket.emit("message", {
    text: input.value.trim(),
    color: myColor,
    to: privateTo || undefined
  });
  input.value = "";
  privateTo = "";
  privateTarget.value = "";
};

document.getElementById("zecchoBtn").onclick = () => {
  socket.emit("message", { text: "çµ¶é ‚è¨±å¯" });
};

input.addEventListener("keydown", e => {
  if (e.key === "Enter" && !e.shiftKey) {
    e.preventDefault();
    sendBtn.click();
  }
});

leaveBtn.onclick = () => {
  socket.emit("leave");
  localStorage.removeItem("chatName");
  localStorage.removeItem("chatRoom");
  localStorage.removeItem("chatKey");
  location.href = "/lobby.html";
};

// ===== ã™ã”ã‚ãé€šå¸¸ãƒ€ã‚¤ã‚¹é€ä¿¡ =====
function rollDice(sides){
  socket.emit("sugorokuRoll", { sides });
}

document.getElementById("ruleBtn").onclick = () => {
  const w = window.open("", "_blank");

  w.document.write("<pre>" +
    document.getElementById("roomDesc").innerText +
    "</pre>");
};

function tryLuck(){

  const n = Math.floor(Math.random()*10)+1;

  socket.emit("message", {
    text: `ğŸ² é‹è©¦ã— â†’ ${n}`
  });

  const btn =
    document.getElementById("luckBtn");

  if (btn){
    btn.style.display = "none";
  }


}
socket.on("sugorokuEvent", ({ type }) => {

  const btn =
    document.getElementById("specialDiceBtn");

  if (type === "luck") {

    if (!btn) return;

  btn.style.display = "inline-block";
  btn.textContent = "1d10";

  btn.onclick = () => {

    const n = Math.floor(Math.random()*10)+1;

    socket.emit("message", {
      text: `ğŸ² 1d10 â†’ ${n}`
    });

  };
  return;
}



  btn.style.display = "inline-block";

  if (type === "14" || type === "24" || type === "40") {
    btn.textContent = "2d6";
  }
  else if (type === "2d4") {
    btn.textContent = "2d4";
  }




  btn.style.backgroundColor = "red";
  btn.style.color = "white";
  btn.style.padding = "8px 12px";
  btn.style.borderRadius = "6px";

  btn.onclick = () => {

    let d1 = 0;
    let d2 = 0;
    let total = 0;

    // ===== 14 / 24 =====
    if (type === "14" || type === "24") {

      d1 = Math.floor(Math.random()*6)+1;
      d2 = Math.floor(Math.random()*6)+1;
      total = d1 + d2;

      socket.emit("message", {
        text: `ğŸ² 2d6 â†’ ${d1},${d2} = ${total}`
      });

      if (d1 === d2) {


        if (type === "14") {
          socket.emit("sugorokuMoveTo", { pos: 1 });
        }

        if (type === "24") {
          socket.emit("sugorokuMoveTo", { pos: 16 });
        }

      }

 

    }


    // ===== 40ï¼ˆã‚´ãƒ¼ãƒ«ç”¨ï¼‰=====
    if (type === "40") {

      d1 = Math.floor(Math.random()*6)+1;
      d2 = Math.floor(Math.random()*6)+1;
      total = d1 + d2;

      socket.emit("message", {
        text: `ğŸ² 2d6 â†’ ${d1},${d2} = ${total}`
      });

  if (d1 === d2) {

  if (type === "40") {

    socket.emit("message", {
      text: "ğŸ ã‚´ãƒ¼ãƒ«ï¼çµ¶é ‚è§£æ”¾"
    });

  const btn = document.getElementById("zecchoBtn");
if (btn) btn.style.display = "inline-block";

  }

} else {

  socket.emit("message", {
    text: "âš  å¯¸æ­¢ã‚1å›"
  });

}
    }

    // ===== 2d4 =====
    if (type === "2d4") {

      d1 = Math.floor(Math.random()*4)+1;
      d2 = Math.floor(Math.random()*4)+1;
      total = d1 + d2;

      socket.emit("message", {
        text: `ğŸ² 2d4 â†’ ${d1},${d2} = ${total}`
      });

      socket.emit("sugorokuBack", {
        steps: total
      });

    }

  };

});

socket.on("showLuckBtn", () => {

  const btn =
    document.getElementById("luckBtn");

  if (btn){
    btn.style.display = "inline-block";
  }

});

window.addEventListener("load", () => {




  
  // ===== ã‚¿ã‚¤ãƒãƒ¼ãƒœã‚¿ãƒ³ï¼ˆé€šå¸¸ã¨é›»æ°—åˆ†é›¢ï¼‰ =====

// é€šå¸¸
const normalTimer3Btn =
  document.getElementById("timer3Btn");

const normalTimer5Btn =
  document.getElementById("timer5Btn");

if (normalTimer3Btn){
  normalTimer3Btn.onclick = () => {
    socket.emit("timerStart", { seconds: 180 });
  };
}

if (normalTimer5Btn){
  normalTimer5Btn.onclick = () => {
    socket.emit("timerStart", { seconds: 300 });
  };
}



// ===== ä»»æ„ã‚¿ã‚¤ãƒãƒ¼ï¼ˆé€šå¸¸ï¼‰ =====
const normalTimerCustomBtn =
  document.getElementById("timerCustomBtn");

const normalTimerCustomInput =
  document.getElementById("timerCustomInput");

if (normalTimerCustomBtn){

  normalTimerCustomBtn.onclick = () => {

    const min =
      parseInt(normalTimerCustomInput.value);

    if (!min || min <= 0) return;

    socket.emit("timerStart", {
      seconds: min * 60
    });

    normalTimerCustomInput.value = "";

  };

}






});



</script>

</body>
</html>
